WITH TablespaceAlter AS (
    SELECT ROW_NUMBER() OVER() AS STMTNUM,
           CHAR('ALTER TABLESPACE '||RTRIM(DBNAME)||'.'||RTRIM(NAME),80) AS L0,
           CHAR('  '||'SECQTY 360000 ;',80) AS L1,
           cHAR(' ',80) AS L2,
           1 AS DDLID
    FROM SYSIBM.SYSTABLESPACE
    WHERE CREATOR LIKE '%SADM' AND SECQTYI / 180 > 600
),

Tablespacepart AS (
    SELECT ROW_NUMBER() OVER() AS STMTNUM, 
      CHAR('ALTER TABLESPACE '||RTRIM(TP.DBNAME)||'.'||RTRIM(TP.TSNAME)) AS L0,
      CHAR ('  '||'ALTER PARTITION '||TRIM(TP.PARTITION)) AS L1,
     CHAR( ' SECQTY 360000 ;')   AS L2,
     2 AS DDLID
    FROM SYSIBM.SYSTABLEPART TP ,
         SYSIBM.SYSTABLESPACE TS
    WHERE TP.DBNAME = TS.DBNAME
    AND   TP.TSNAME = TS.NAME
    AND   TS.CREATOR LIKE '%SADM' 
    AND TP.SECQTYI / 180 > 600 AND TP.PARTITION <> '0'
),

IndexAlter AS (
    SELECT ROW_NUMBER() OVER() AS STMTNUM,
CHAR('ALTER INDEX  '||RTRIM(IX.CREATOR)||'.'||TRIM(IX.NAME)) AS L0,
           CHAR('  '||'SECQTY 360000 ;') AS L1,
           CHAR(' ') AS L2,
          3 AS DDLID
    FROM SYSIBM.SYSINDEXES IX
    WHERE IX.CREATOR LIKE '%P1DBO%' AND IX.SECQTYI / 180 > 600
),       

Indexpart As (
    SELECT ROW_NUMBER() OVER() AS STMTNUM,
CHAR('ALTER INDEX  '||RTRIM(IP.IXCREATOR)||'.'||TRIM(IP.IXNAME)) AS L0,
           CHAR('  '||'PARTITION '||TRIM(IP.PARTITION)) AS L1,
           CHAR(' SECQTY 360000 ;')  AS L2  ,
           4 As DDLID
    FROM SYSIBM.SYSINDEXPART IP
    WHERE IP.IXCREATOR LIKE '%P1DBO%' AND IP.SECQTYI / 180 > 600 AND IP.PARTITION <> '0'
)
,
RESULTTB AS (
SELECT STMTNUM, L0,L1,L2,DDLID FROM TablespaceAlter
UNION ALL
SELECT STMTNUM, L0,L1,L2,DDLID FROM Tablespacepart
UNION ALL
SELECT STMTNUM, L0,L1,L2,DDLID FROM IndexAlter
UNION ALL
SELECT STMTNUM, L0,L1,L2,DDLID FROM Indexpart
)

SELECT CHAR(STMT,80) FROM
(
SELECT CHAR(L0,80) AS STMT, STMTNUM, DDLID, 0 AS STMTID FROM RESULTTB
UNION ALL
SELECT CHAR(L1,80) AS STMT, STMTNUM, DDLID, 1 AS STMTID FROM RESULTTB
UNION ALL
SELECT CHAR(L2,80) AS STMT, STMTNUM, DDLID, 2 AS STMTID FROM RESULTTB
) X ORDER BY DDLID, STMTNUM, STMTID WITH UR;



--SELECT L0,L1,L2 FROM TablespaceAlter
--UNION ALL
--SELECT L0,L1,L2 FROM Tablespacepart
--UNION ALL
--SELECT L0,L1,L2 FROM IndexAlter
--UNION ALL
--SELECT L0,L1,L2 FROM Indexpart
